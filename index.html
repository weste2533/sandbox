<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fund Data Viewer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 2rem;
            background-color: #f5f5f5;
        }
        #container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #loading {
            text-align: center;
            padding: 1rem;
            color: #666;
        }
        #error {
            color: #dc3545;
            padding: 1rem;
            border: 1px solid #dc3545;
            margin: 1rem 0;
            border-radius: 4px;
            display: none;
        }
        #debug {
            font-family: monospace;
            white-space: pre-wrap;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            max-height: 400px;
            overflow: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
        }
        .action-buttons {
            margin-top: 1rem;
            display: flex;
            gap: 1rem;
        }
        button {
            padding: 0.5rem 1rem;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #0069d9;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        #summary {
            margin-top: 1rem;
            padding: 0.5rem;
            background-color: #e9f7fd;
            border-radius: 4px;
            color: #0069d9;
        }
        .fund-status {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.875rem;
            margin-left: 0.5rem;
        }
        .status-success {
            background-color: #d4edda;
            color: #155724;
        }
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .progress-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 4px;
            margin: 0.5rem 0;
        }
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background-color: #007bff;
            width: 0%;
            transition: width 0.3s;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
            border-radius: 4px 4px 0 0;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            color: #333;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #007bff;
            color: white;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>Mutual Fund Data Viewer</h1>
        <div id="loading">ðŸš€ Initializing...</div>
        <div id="error"></div>
        <div id="summary" style="display:none;"></div>
        <div class="progress-container" id="progressContainer" style="display:none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div id="fundStatus" style="margin-top: 1rem; display:none;"></div>
        
        <div class="tab" id="tabContainer" style="display:none;">
            <button class="tablinks active" onclick="openTab(event, 'marketDataTab')">Market Data</button>
            <button class="tablinks" onclick="openTab(event, 'distributionsTab')">Distributions</button>
            <button class="tablinks" onclick="openTab(event, 'afaxxRatesTab')">AFAXX Rates</button>
        </div>
        
        <div id="marketDataTab" class="tabcontent" style="display:block;">
            <h2>NAV & Dividend Data</h2>
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>ANCFX NAV</th>
                        <th>ANCFX Distribution</th>
                        <th>AGTHX NAV</th>
                        <th>AGTHX Distribution</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
        
        <div id="distributionsTab" class="tabcontent">
            <h2>Fund Distributions Data</h2>
            <div id="distributionsContent"></div>
        </div>
        
        <div id="afaxxRatesTab" class="tabcontent">
            <h2>AFAXX Interest Rates</h2>
            <table id="afaxxTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Rate</th>
                    </tr>
                </thead>
                <tbody id="afaxxTableBody"></tbody>
            </table>
        </div>
        
        <div id="debug"></div>
        
        <div class="action-buttons" id="buttonContainer" style="display:none;">
            <button id="downloadBtn">Download as HTML</button>
            <button id="retryBtn" style="display:none;">Retry Failed Loads</button>
        </div>
    </div>

    <script>
        // Logging utility
        let debugLog = [];
        function log(message) {
            const timestamp = new Date().toISOString().split('T')[1].slice(0, 8);
            debugLog.push(`[${timestamp}] ${message}`);
            document.getElementById('debug').textContent = debugLog.join('\n');
        }
        
        // More reliable proxy list
        const PROXIES = [
            "https://corsproxy.io/?", 
            "https://api.allorigins.win/get?url=",
            "https://thingproxy.freeboard.io/fetch/",
            "https://cors-anywhere.herokuapp.com/",
            "https://crossorigin.me/"
        ];

        const FUNDS = ['ANCFX', 'AGTHX', 'AFAXX'];
        let marketData = {}; // Object to store Yahoo Finance data by date for each fund
        let distributionData = null; // To store parsed distribution data from the text file
        let fundStatus = {}; // Track loading status for each fund
        let failedFunds = []; // Track which funds failed to load
        let loadingTasks = 0; // Counter for overall loading progress

        // Initialize fund status
        FUNDS.forEach(fund => {
            fundStatus[fund] = { 
                status: 'pending', 
                attempts: 0,
                marketDataLoaded: false,
                distributionDataLoaded: false
            };
        });

        // ---------------------------------------------
        // Functions from fund-distribution-parser.js
        // ---------------------------------------------
        
        /**
         * Loads and parses fund distribution data from a text file
         * @param {string} fileUrl - URL of the distributions text file to load
         * @returns {Promise<Object>} - Promise resolving to an object containing the parsed fund data
         */
        function loadFundDistributionData(fileUrl) {
            return new Promise((resolve, reject) => {
                fetch(fileUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`Failed to fetch file: ${response.status} ${response.statusText}`);
                        }
                        return response.text();
                    })
                    .then(data => {
                        const result = parseDistributionData(data);
                        resolve(result);
                    })
                    .catch(error => {
                        reject(error);
                    });
            });
        }

        /**
         * Parses the distribution data text content
         * @param {string} data - Raw text content from the distributions file
         * @returns {Object} - Object containing parsed fund data
         */
        function parseDistributionData(data) {
            const lines = data.trim().split('\n');
            
            let currentFund = null;
            let isHeader = false;
            let headers = [];
            
            const fundData = {
                ANCFX: {
                    distributions: [],
                    headers: []
                },
                AGTHX: {
                    distributions: [],
                    headers: []
                },
                AFAXX: {
                    rates: []
                }
            };
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // Skip empty lines
                if (line === '') continue;
                
                // Detect fund
                if (line === 'ANCFX') {
                    currentFund = 'ANCFX';
                    isHeader = true;
                    continue;
                } else if (line === 'AGTHX') {
                    currentFund = 'AGTHX';
                    isHeader = true;
                    continue;
                } else if (line === 'AFAXX') {
                    currentFund = 'AFAXX';
                    isHeader = true;
                    continue;
                }
                
                // Process headers
                if (isHeader) {
                    headers = line.split('\t');
                    if (currentFund === 'ANCFX' || currentFund === 'AGTHX') {
                        fundData[currentFund].headers = headers;
                    }
                    isHeader = false;
                    continue;
                }
                
                // Process data rows
                const values = line.split('\t');
                
                if (currentFund === 'ANCFX' || currentFund === 'AGTHX') {
                    if (values.length === headers.length) {
                        // Create object with header keys and row values
                        const rowObj = {};
                        headers.forEach((header, index) => {
                            rowObj[header] = values[index];
                        });
                        fundData[currentFund].distributions.push(rowObj);
                    }
                } else if (currentFund === 'AFAXX') {
                    if (values.length === 2) {
                        fundData[currentFund].rates.push({
                            rate: values[0],
                            date: values[1]
                        });
                    }
                }
            }
            
            return fundData;
        }

        /**
         * Formats a date string from MM/DD/YY to MM/DD/YYYY
         * @param {string} dateString - Date string in MM/DD/YY format
         * @returns {string} - Formatted date string
         */
        function formatDate(dateString) {
            // Check if date is in MM/DD/YY format and convert to MM/DD/YYYY if needed
            const parts = dateString.split('/');
            if (parts.length === 3 && parts[2].length === 2) {
                const year = parts[2].startsWith('0') ? '20' + parts[2] : '20' + parts[2];
                return `${parts[0]}/${parts[1]}/${year}`;
            }
            return dateString;
        }
        
        // ---------------------------------------------
        // Enhanced fetch with retry and proxy support
        // ---------------------------------------------
        
        async function fetchWithRetry(url, maxAttempts = 3, initialDelay = 1000) {
            for (let proxyIndex = 0; proxyIndex < PROXIES.length; proxyIndex++) {
                const proxyUrl = PROXIES[proxyIndex] + encodeURIComponent(url);
                
                for (let attempt = 0; attempt < maxAttempts; attempt++) {
                    try {
                        const start = Date.now();
                        log(`Proxy ${proxyIndex + 1}/${PROXIES.length} - Attempt ${attempt + 1}/${maxAttempts}: ${url}`);
                        
                        const response = await fetch(proxyUrl, {
                            method: 'GET',
                            headers: {
                                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
                            },
                            cache: 'no-cache'
                        });
                        
                        const latency = Date.now() - start;
                        log(`Status: ${response.status} â€¢ Latency: ${latency}ms`);

                        if (!response.ok) {
                            throw new Error(`HTTP error: ${response.status}`);
                        }

                        // Try to handle different response formats
                        let data;
                        const contentType = response.headers.get('content-type');
                        if (contentType && contentType.includes('application/json')) {
                            data = await response.json();
                        } else {
                            const text = await response.text();
                            try {
                                data = JSON.parse(text);
                            } catch (e) {
                                data = text;
                            }
                        }
                        
                        return data.contents || data;
                    } catch (error) {
                        log(`Error with Proxy ${proxyIndex + 1} - Attempt ${attempt + 1}: ${error.message}`);
                        
                        // If this is not the last attempt, wait before retrying
                        if (attempt < maxAttempts - 1) {
                            const delay = initialDelay * Math.pow(2, attempt);
                            log(`Waiting ${delay}ms before retry...`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                        }
                    }
                }
            }
            throw new Error('All proxies and retry attempts failed');
        }

        // ---------------------------------------------
        // UI Management Functions
        // ---------------------------------------------
        
        function updateLoading(message) {
            document.getElementById('loading').textContent = message;
            log(message);
        }
        
        function showError(message) {
            document.getElementById('error').innerHTML = `âŒ Error: ${message}`;
            document.getElementById('error').style.display = 'block';
            log(`ERROR: ${message}`);
        }
        
        function updateProgress() {
            // Calculate overall progress
            const totalTasks = FUNDS.length * 2 + 1; // Market data for each fund + distribution file
            const progress = Math.min(Math.round((loadingTasks / totalTasks) * 100), 100);
            
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            if (progress === 100) {
                setTimeout(() => {
                    document.getElementById('progressContainer').style.display = 'none';
                    document.getElementById('loading').style.display = 'none';
                }, 500);
            }
        }
        
        function updateFundStatusDisplay() {
            const statusDiv = document.getElementById('fundStatus');
            statusDiv.innerHTML = '';
            
            FUNDS.forEach(fund => {
                const status = fundStatus[fund];
                let statusClass = 'status-pending';
                let statusText = 'Pending';
                
                if (status.status === 'success') {
                    statusClass = 'status-success';
                    statusText = 'Loaded';
                } else if (status.status === 'error') {
                    statusClass = 'status-error';
                    statusText = `Failed (${status.attempts} attempts)`;
                } else if (status.status === 'loading') {
                    statusText = 'Loading...';
                }
                
                statusDiv.innerHTML += `
                    <div>
                        <strong>${fund}</strong>
                        <span class="fund-status ${statusClass}">${statusText}</span>
                    </div>
                `;
            });
            
            statusDiv.style.display = 'block';
        }
        
        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            
            const tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            
            document.getElementById(tabName).style.display = "block";
            if (evt) evt.currentTarget.className += " active";
        }

        // ---------------------------------------------
        // Data Loading Functions
        // ---------------------------------------------
        
        async function loadMarketData(fund) {
            try {
                fundStatus[fund].status = 'loading';
                fundStatus[fund].attempts++;
                updateFundStatusDisplay();
                updateLoading(`Fetching ${fund} market data (Attempt ${fundStatus[fund].attempts})...`);
                
                // Calculate date range (Jan 1, 2024 to yesterday)
                const startDate = new Date('2024-01-01');
                const endDate = new Date();
                endDate.setDate(endDate.getDate() - 1);
                const period1 = Math.floor(startDate.getTime() / 1000);
                const period2 = Math.floor(endDate.getTime() / 1000);

                // Try to fetch NAV data with multiple attempts
                let navSuccess = false;
                try {
                    // Fetch NAV data
                    const navUrl = `https://query1.finance.yahoo.com/v8/finance/chart/${fund}?period1=${period1}&period2=${period2}&interval=1d`;
                    let navResponse = await fetchWithRetry(navUrl, 3, 1000);
                    
                    // Ensure navResponse is properly parsed
                    let navParsed;
                    if (typeof navResponse === 'string') {
                        try {
                            navParsed = JSON.parse(navResponse);
                        } catch (error) {
                            log(`Failed to parse NAV response for ${fund}: ${error.message}`);
                            log(`Response sample: ${navResponse.substring(0, 100)}...`);
                            throw new Error(`Failed to parse NAV data for ${fund}`);
                        }
                    } else {
                        navParsed = navResponse;
                    }
                    
                    if (!navParsed.chart?.result?.length) {
                        log(`No NAV data available for ${fund}`);
                        throw new Error(`No NAV data available for ${fund}`);
                    }

                    const result = navParsed.chart.result[0];
                    const timestamps = result.timestamp;
                    const closes = result.indicators.quote[0].close;

                    // Process NAV data
                    timestamps.forEach((ts, i) => {
                        const date = new Date(ts * 1000).toISOString().split('T')[0];
                        if (!marketData[date]) {
                            marketData[date] = {};
                        }
                        
                        marketData[date][`${fund}_nav`] = closes[i] ? closes[i].toFixed(2) : null;
                    });

                    navSuccess = true;
                    log(`${fund} NAV data retrieved. Timestamps: ${timestamps.length}`);
                } catch (error) {
                    log(`Error loading NAV data for ${fund}: ${error.message}`);
                }

                // Try to fetch dividend data independently from NAV data
                let divSuccess = false;
                try {
                    // Fetch dividend data with multiple retries
                    const divUrl = `https://query1.finance.yahoo.com/v7/finance/download/${fund}?period1=${period1}&period2=${period2}&events=div`;
                    const divResponse = await fetchWithRetry(divUrl, 3, 1000);
                    
                    // Process dividend data
                    let divText;
                    if (typeof divResponse === 'string') {
                        divText = divResponse;
                    } else if (divResponse.contents) {
                        divText = divResponse.contents;
                    }

                    if (divText) {
                        const dividends = {};
                        divText.split('\n').slice(1).forEach(row => {
                            if (row) {
                                const [date, amount] = row.split(',');
                                if (date && amount) dividends[date] = parseFloat(amount).toFixed(3);
                            }
                        });

                        // Store dividend data
                        Object.keys(dividends).forEach(date => {
                            if (!marketData[date]) {
                                marketData[date] = {};
                            }
                            marketData[date][`${fund}_div`] = dividends[date];
                        });

                        divSuccess = true;
                        log(`${fund} dividend data retrieved. Entries: ${Object.keys(dividends).length}`);
                    } else {
                        log(`No dividend data found for ${fund}`);
                        divSuccess = true; // Not finding dividends is not an error
                    }
                } catch (error) {
                    log(`Error loading dividend data for ${fund}: ${error.message}`);
                }

                // Update fund status based on market data success
                if (navSuccess && divSuccess) {
                    fundStatus[fund].marketDataLoaded = true;
                    // Remove from failed funds list if it was there
                    failedFunds = failedFunds.filter(f => f !== fund);
                } else {
                    // If either NAV or dividend data failed, consider market data error
                    // but keep any partial data we might have received
                    if (!failedFunds.includes(fund)) {
                        failedFunds.push(fund);
                    }
                }

                // Update overall fund status
                updateFundStatus(fund);
                loadingTasks++;
                updateProgress();

            } catch (error) {
                log(`Critical error processing ${fund}: ${error.message}`);
                if (!failedFunds.includes(fund)) {
                    failedFunds.push(fund);
                }
                
                // Update overall fund status
                updateFundStatus(fund);
                loadingTasks++;
                updateProgress();
            }
        }
        
        function updateFundStatus(fund) {
            // Update overall fund status
            if (fundStatus[fund].marketDataLoaded && 
               (fund === 'AFAXX' || distributionData !== null)) {
                fundStatus[fund].status = 'success';
            } else {
                fundStatus[fund].status = 'error';
            }
            updateFundStatusDisplay();
        }
        
        async function loadDistributions() {
            try {
                updateLoading('Loading distribution data from text file...');
                
                // Load distributions.txt file from the same directory
                const distributionsUrl = 'distributions.txt';
                distributionData = await loadFundDistributionData(distributionsUrl);
                
                log('Distribution data loaded successfully');
                log(`ANCFX: ${distributionData.ANCFX.distributions.length} distributions`);
                log(`AGTHX: ${distributionData.AGTHX.distributions.length} distributions`);
                log(`AFAXX: ${distributionData.AFAXX.rates.length} rates`);
                
                // Update fund status for each fund now that we have distribution data
                FUNDS.forEach(fund => {
                    fundStatus[fund].distributionDataLoaded = true;
                    updateFundStatus(fund);
                });
                
                loadingTasks++;
                updateProgress();
                
                // Render distribution data
                displayDistributionData();
                displayAFAXXRates();
                
            } catch (error) {
                log(`Error loading distribution data: ${error.message}`);
                showError(`Failed to load distribution data: ${error.message}`);
                loadingTasks++;
                updateProgress();
            }
        }
        
        function displayDistributionData() {
            if (!distributionData) return;
            
            const container = document.getElementById('distributionsContent');
            container.innerHTML = '';
            
            // Display ANCFX and AGTHX distributions
            ['ANCFX', 'AGTHX'].forEach(fund => {
                const fundData = distributionData[fund];
                if (!fundData || !fundData.headers.length) return;
                
                const section = document.createElement('div');
                section.innerHTML = `<h3>${fund} Distributions</h3>`;
                
                const table = document.createElement('table');
                
                // Create table header
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                fundData.headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);
                
                // Create table body
                const tbody = document.createElement('tbody');
                fundData.distributions.forEach(dist => {
                    const row = document.createElement('tr');
                    fundData.headers.forEach(header => {
                        const td = document.createElement('td');
                        td.textContent = dist[header] || '-';
                        row.appendChild(td);
                    });
                    tbody.appendChild(row);
                });
                table.appendChild(tbody);
                
                section.appendChild(table);
                container.appendChild(section);
            });
        }
        
        function displayAFAXXRates() {
            if (!distributionData || !distributionData.AFAXX) return;
            
            const tbody = document.getElementById('afaxxTableBody');
            tbody.innerHTML = '';
            
            // Sort rates by date (newest first)
            const rates = [...distributionData.AFAXX.rates].sort((a, b) => {
                return new Date(b.date) - new Date(a.date);
            });
            
            // Add rows
            rates.forEach(rate => {
                const row = document.createElement('tr');
                
                const dateCell = document.createElement('td');
                dateCell.textContent = formatDate(rate.date);
                row.appendChild(dateCell);
                
                const rateCell = document.createElement('td');
                rateCell.textContent = rate.rate + '%';
                row.appendChild(rateCell);
                
                tbody.appendChild(row);
            });
        }

        function generateMarketDataTable() {
            // Get all dates and sort them in descending order
            let dates = Object.keys(marketData).sort((a, b) => new Date(b) - new Date(a));
            
            // Generate the table rows
            return dates.map(date => {
                const data = marketData[date] || {};
                return `<tr>
                    <td>${date}</td>
                    <td>${data.ANCFX_nav ? '$' + data.ANCFX_nav : 'N/A'}</td>
                    <td>${data.ANCFX_div ? '$' + data.ANCFX_div : '-'}</td>
                    <td>${data.AGTHX_nav ? '$' + data.AGTHX_nav : 'N/A'}</td>
                    <td>${data.AGTHX_div ? '$' + data.AGTHX_div : '-'}</td>
                </tr>`;
            });
        }

        function updateSummary() {
            const summaryElement = document.getElementById('summary');
            const dateRange = `January 1, 2024 to ${new Date().toISOString().split('T')[0]}`;
            
            const loadedFunds = FUNDS.filter(fund => fundStatus[fund].status === 'success').length;
            const failedFundsCount = failedFunds.length;
            
            let statusMessage = `Showing data from ${dateRange} â€¢ Funds loaded: ${loadedFunds}/${FUNDS.length}`;
            
            if (failedFundsCount > 0) {
                statusMessage += ` â€¢ ${failedFundsCount} fund(s) failed to load completely`;
                document.getElementById('retryBtn').style.display = 'block';
                document.getElementById('retryBtn').textContent = `Retry Failed Loads (${failedFundsCount})`;
            } else {
                document.getElementById('retryBtn').style.display = 'none';
            }
            
            summaryElement.textContent = statusMessage;
            summaryElement.style.display = 'block';
        }

        async function loadAllData() {
            try {
                document.getElementById('progressContainer').style.display = 'block';
                updateProgress();
                
                // Load market data and distributions in parallel
                const loadPromises = [
                    ...FUNDS.map(fund => loadMarketData(fund)),
                    loadDistributions()
                ];
                
                await Promise.allSettled(loadPromises);
                
                // Generate and display market data table
                document.getElementById('tableBody').innerHTML = generateMarketDataTable().join('');
                
                // Show UI elements
                document.getElementById('tabContainer').style.display = 'block';
                document.getElementById('buttonContainer').style.display = 'flex';
                document.getElementById('summary').style.display = 'block';
                
                updateSummary();
                
            } catch (error) {
                showError(`Failed to load data: ${error.message}`);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function downloadAsHTML() {
            // Create a complete HTML document
            const html = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mutual Fund Data</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1, h2 { color: #333; }
        .info { color: #666; margin-bottom: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2;
